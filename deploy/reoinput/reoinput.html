<html>

<head>
	
</head>


<template>
	<style>
		.spinbut{
			width:15px;
			display:block;
			font-size:5px;
			margin:0px;
			padding:0px;
			text-align:center;
		}
		input:invalid{
			color:red;
		}
	</style>
	<div>
		<table id="rin" style="color:inherit;min-width:350px;width:100%;" cellspacing=0>
			<tr>
				<td rowspan=1 style="padding:0;">
					<input id="enabled" type="checkbox" checked="false"/>
				</td>
				<td style="text-align:right;">
					<input id="barcode" type="text" pattern="[0-2]?[0-9]N(10|12|16|20|24|28|32|36|40)" value="2N10" placeholder="??N??" style="text-align:right;padding-right:0.5em;width:5em;font-weight:bold;color:;"/>
					
				</td>
				<td style="text-align:left;">
					<button tabindex="-1" class="spinbut" id="spinbutup">&#9650;</button>
					<button tabindex="-1" class="spinbut" id="spinbutdown">&#9660;</button>
				</td>
				<td style="text-align:right;padding-left:1em;">
					<input type="number" min="0" step="10" value="0" style="text-align:right;width:5em;"/>
				</td>
				<td style="text-align:left;padding-left:0;">
					mm
				</td>
				<td style="text-align:right;padding-right:0;padding-left:1em;">
					from
				</td>
				<td>
					<select style="width:100%">
						<option value="top">top</option>
						<option value="highest">highest</option>
						<option value="lowest" selected>lowest</option>
						<option value="bottom">bottom</option>
					</select>
				</td>
			</tr>
		</table>
	</div>
</template>


<body>
	<style>
		#rout td{
			border-bottom:1px solid lightgrey;
		}
		.tableout{
			color:darkblue;
			text-align:right;
			font-family:sans-serif;
			padding-right:0;
			min-width:50px;
			font-size:90%;
		}
	</style>
	<div style="width:70%;">
		
		
		
		<reo-input> </reo-input>
		<reo-input> </reo-input>
		<reo-input> </reo-input>
		<reo-input> </reo-input>
		<table id="rout" style="width:100%;min-width:350px;" cellspacing=0>
			<tr>
				<td>Depth from top surface:</td>
				<td class="tableout">1200</td>
				<td>mm</td>
			</tr>
			<tr>
				<td>Crossectional area of steel:</td>
				<td class="tableout">30000</td>
				<td>mm&#178;</td>
			</tr>
			
			<tr>
				<td rowspan=3>Amount:</td>
				<td class="tableout">10</td>
				<td>m</td>
			</tr>
			<tr>
				<td class="tableout">5</td>
				<td>kg/m</td>
			</tr>
			<tr>
				<td class="tableout">400</td>
				<td>kg</td>
			</tr>
			<tr>
				<td style="border-bottom:none;">Depth from top surface:</td>
				<td style="border-bottom:none;"  class="tableout">1200</td>
				<td style="border-bottom:none;" >mm</td>
			</tr>
		</table>
	</div>
	
	
	
		<script>
	ReoInputPrototype = Object.create(HTMLElement.prototype);
	ReoInputPrototype.createdCallback = function(){
		this.create = function(){
			this.webkitCreateShadowRoot();
			var imported = document.importNode(document.querySelector("template").content);
			this.webkitShadowRoot.appendChild(imported);
			this.doc = this.webkitShadowRoot;
			
			this.maindiv = this.doc.querySelector("div");
			this.enabledCheck = this.doc.querySelector("#enabled");
			this.enabledCheck.addEventListener("change",function(){
				this.enabled = this.enabled;
			}.bind(this));
			
			this.barcodeIn = this.doc.querySelector("#barcode");
			this.barcodeIn.addEventListener("keydown",function(e){
				if(e.keyCode == 38){	// up button
					this.more();
					e.preventDefault();
				}
				if(e.keyCode == 40){	// down button
					this.less();
					e.preventDefault();
				}
			}.bind(this))
			this.more = function(){}.bind(this);
			this.barcodeIn.addEventListener("input",function(e){
				var val = e.target.value;
				var ss = e.target.selectionStart;
				var se = e.target.selectionEnd;
				var arr = val.split("")
				var flag = false;
				var noN = true;
				for(var i=0;i<arr.length;i++){
					
					if((/[^0-9nN]/).test(arr[i])){
						arr.splice(i--,1);
						;
						if(i<ss){
							ss--;
							se=ss;
						}
					}
					if(arr[i]=="N"){
						noN = false;
					}
				}
				val = arr.join("");
				val = val.toUpperCase();
				e.target.value =  val;
				e.target.setSelectionRange(ss,se);
			}.bind(this))
			
			this.selected = false;
			this.addEventListener("mouseup",this.select);
			this.addEventListener("keyup",this.select);
		}.bind(this)
		
		
		
		Object.defineProperty(this,"enabled",{
			get:function(){
				return this.enabledCheck.checked;
			}.bind(this),
			set:function(newval){
				this.enabledCheck.checked = newval;
				var ins = this.doc.querySelectorAll("input, button, select")
				for(var i = 0; i < ins.length;i++){
					if(ins[i].id!="enabled"){
						ins[i].disabled=!newval;
					}
				}
				if(newval){
					this.maindiv.style.color = "";
				}else{
					this.maindiv.style.color = "grey";
				}
			}.bind(this),
		});
		this.select = function(){
			this.selected = true;
			var others = document.querySelectorAll("reo-input");
			for(var i = 0; i<others.length;i++){
				others[i].deselect();
			}
			console.log();
			this.maindiv.style.backgroundColor = "highlight";
		}.bind(this);
		this.deselect = function(){
			this.selected = false;
			this.maindiv.style.backgroundColor = "";
		}.bind(this);
		this.create();
	};
	
	
	
	var ReoInput = document.registerElement("reo-input",{prototype:ReoInputPrototype});
	
		</script>
</body>




</html>